<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='ç®€ä»‹ é‡‡ç”¨ eBPF åŸºäº Memcached çš„æ€§èƒ½ä¼˜åŒ–ã€‚ ä½¿ç”¨åŸºäº DPDK çš„è§£å†³æ–¹æ¡ˆç»•è¿‡ Linux ç½‘ç»œå †æ ˆï¼Œä½†æ­¤ç±»æ–¹æ³•éœ€è¦å®Œå…¨é‡æ–°è®¾è®¡è½¯ä»¶å †æ ˆï¼Œå¹¶ä¸”å³ä½¿åœ¨å®¢æˆ·ç«¯è´Ÿè½½è¾ƒä½æ—¶ä¹Ÿä¼šå¯¼è‡´ CPU åˆ©ç”¨'><title>[NSDI22] BMC: Accelerating Memcached Using Safe in Kernel Caching and Pre Stack Processing</title>
<link rel=canonical href=https://chasing1020.github.io/post/nsdi22/><link rel=stylesheet href=/scss/style.min.d474cae5c45bbcf637797ca9373a85f97ea6d56997986627823ed313a3434305.css><meta property='og:title' content='[NSDI22] BMC: Accelerating Memcached Using Safe in Kernel Caching and Pre Stack Processing'><meta property='og:description' content='ç®€ä»‹ é‡‡ç”¨ eBPF åŸºäº Memcached çš„æ€§èƒ½ä¼˜åŒ–ã€‚ ä½¿ç”¨åŸºäº DPDK çš„è§£å†³æ–¹æ¡ˆç»•è¿‡ Linux ç½‘ç»œå †æ ˆï¼Œä½†æ­¤ç±»æ–¹æ³•éœ€è¦å®Œå…¨é‡æ–°è®¾è®¡è½¯ä»¶å †æ ˆï¼Œå¹¶ä¸”å³ä½¿åœ¨å®¢æˆ·ç«¯è´Ÿè½½è¾ƒä½æ—¶ä¹Ÿä¼šå¯¼è‡´ CPU åˆ©ç”¨'><meta property='og:url' content='https://chasing1020.github.io/post/nsdi22/'><meta property='og:site_name' content='Chasing1020'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2024-04-24T18:52:23+08:00'><meta property='article:modified_time' content='2024-04-24T18:52:23+08:00'><meta name=twitter:site content="@Chasing1020"><meta name=twitter:creator content="@Chasing1020"><meta name=twitter:title content="[NSDI22] BMC: Accelerating Memcached Using Safe in Kernel Caching and Pre Stack Processing"><meta name=twitter:description content="ç®€ä»‹ é‡‡ç”¨ eBPF åŸºäº Memcached çš„æ€§èƒ½ä¼˜åŒ–ã€‚ ä½¿ç”¨åŸºäº DPDK çš„è§£å†³æ–¹æ¡ˆç»•è¿‡ Linux ç½‘ç»œå †æ ˆï¼Œä½†æ­¤ç±»æ–¹æ³•éœ€è¦å®Œå…¨é‡æ–°è®¾è®¡è½¯ä»¶å †æ ˆï¼Œå¹¶ä¸”å³ä½¿åœ¨å®¢æˆ·ç«¯è´Ÿè½½è¾ƒä½æ—¶ä¹Ÿä¼šå¯¼è‡´ CPU åˆ©ç”¨"><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu95eb581bc5d2486d92921983fc6c7583_36979_300x0_resize_q75_box.jpg width=300 height=299 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ–¥ï¸</span></figure><div class=site-meta><h1 class=site-name><a href=/>Chasing1020</a></h1><h2 class=site-description><a href="https://www.youtube.com/watch?v=_ILsdcs__ME" target=_blank>Why there is a universe?</a></h2></div></header><ol class=social-menu><li><a href=https://github.com/Chasing1020 target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/Chasing1020 target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li><a href=https://t.me/Chasing1020 target=_blank title=Telegram rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-telegram" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 10l-4 4 6 6 4-16-18 7 4 2 2 6 3-4"/></svg></a></li><li><a href=mailto:chasing1020@gmail.com target=_blank title=Email rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-mail" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="3" y="5" width="18" height="14" rx="2"/><polyline points="3 7 12 13 21 7"/></svg></a></li><li><a href=/index.xml target=_blank title=RSS rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="5" cy="19" r="1"/><path d="M4 4a16 16 0 0116 16"/><path d="M4 11a9 9 0 019 9"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/friends/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Friends</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><div class=menu-bottom-section><li id=i18n-switch style=display:none><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://chasing1020.github.io/ selected></option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#ç®€ä»‹>ç®€ä»‹</a></li><li><a href=#ç³»ç»Ÿç»“æ„>ç³»ç»Ÿç»“æ„</a><ul><li><a href=#bmc-ç¼“å­˜è®¾è®¡>BMC ç¼“å­˜è®¾è®¡</a></li><li><a href=#å®ç°æµç¨‹>å®ç°æµç¨‹</a></li></ul></li><li><a href=#æ€»ç»“>æ€»ç»“</a></li></ul></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/post/nsdi22/>[NSDI22] BMC: Accelerating Memcached Using Safe in Kernel Caching and Pre Stack Processing</a></h2></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Apr 24, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>5 minute read</time></div></footer></div></header><section class=article-content><h1 id=ç®€ä»‹>ç®€ä»‹</h1><p>é‡‡ç”¨ eBPF åŸºäº Memcached çš„æ€§èƒ½ä¼˜åŒ–ã€‚
ä½¿ç”¨åŸºäº DPDK çš„è§£å†³æ–¹æ¡ˆç»•è¿‡ Linux ç½‘ç»œå †æ ˆï¼Œä½†æ­¤ç±»æ–¹æ³•éœ€è¦å®Œå…¨é‡æ–°è®¾è®¡è½¯ä»¶å †æ ˆï¼Œå¹¶ä¸”å³ä½¿åœ¨å®¢æˆ·ç«¯è´Ÿè½½è¾ƒä½æ—¶ä¹Ÿä¼šå¯¼è‡´ CPU åˆ©ç”¨ç‡è¾ƒé«˜ã€‚ä½œä¸º Memcached çš„å†…æ ¸ç¼“å­˜ï¼Œå¯åœ¨æ ‡å‡†ç½‘ç»œå †æ ˆæ‰§è¡Œä¹‹å‰ä¸ºè¯·æ±‚æä¾›æœåŠ¡ã€‚å¯¹ BMC ç¼“å­˜çš„è¯·æ±‚è¢«è§†ä¸º NIC ä¸­æ–­çš„ä¸€éƒ¨åˆ†ï¼Œè¿™å…è®¸æ€§èƒ½éšç€æœåŠ¡äº NIC é˜Ÿåˆ—çš„æ ¸å¿ƒæ•°é‡è€Œæ‰©å±•ã€‚ä¸ºäº†ä¿è¯å®‰å…¨ï¼ŒBMC é‡‡ç”¨ eBPF æ¥å®ç°ã€‚å°½ç®¡ eBPF å­˜åœ¨å®‰å…¨é™åˆ¶ï¼Œä½†æˆ‘ä»¬è¯æ˜äº†å®ç°å¤æ‚çš„ç¼“å­˜æœåŠ¡æ˜¯å¯èƒ½çš„ã€‚
ç”±äº BMC è¿è¡Œåœ¨å•†ç”¨ç¡¬ä»¶ä¸Šï¼Œä¸éœ€è¦ä¿®æ”¹ Linux å†…æ ¸å’Œ Memcached åº”ç”¨ç¨‹åºï¼Œå› æ­¤å¯ä»¥å¹¿æ³›éƒ¨ç½²åœ¨ç°æœ‰ç³»ç»Ÿä¸Šã€‚</p><h1 id=ç³»ç»Ÿç»“æ„>ç³»ç»Ÿç»“æ„</h1><p><img src=https://s2.loli.net/2024/04/24/qKEHXe7lrJ3atSO.png loading=lazy alt="BMC: Accelerating Memcached using Safe In-kernel Caching and Pre-stack Processing-2024-04-24-19-41-17"></p><p>å½“å¤„ç† GET è¯·æ±‚ (4a) æ—¶ï¼ŒBMC æ£€æŸ¥å…¶å†…æ ¸ç¼“å­˜ï¼Œå¦‚æœæ‰¾åˆ°è¯·æ±‚çš„æ•°æ®ï¼Œåˆ™å‘å›ç›¸åº”çš„å›å¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŒ…å«è¯·æ±‚çš„ç½‘ç»œæ•°æ®åŒ…æ°¸è¿œä¸ä¼šç”±æ ‡å‡†ç½‘ç»œå †æ ˆæˆ–åº”ç”¨ç¨‹åºå¤„ç†ï¼Œä»è€Œé‡Šæ”¾ CPU æ—¶é—´ã€‚</p><p>SET è¯·æ±‚ç”± BMC å¤„ç†ä»¥ä½¿ç›¸åº”çš„ç¼“å­˜æ¡ç›®æ— æ•ˆï¼Œç„¶åä¼ é€’ç»™åº”ç”¨ç¨‹åº (4b)ã€‚ç¼“å­˜æ¡ç›®å¤±æ•ˆåï¼Œé’ˆå¯¹ç›¸åŒæ•°æ®çš„åç»­ GET è¯·æ±‚å°†ä¸ä¼šç”± BMC æä¾›æœåŠ¡ï¼Œè€Œæ˜¯ç”± Memcached åº”ç”¨ç¨‹åºæä¾›æœåŠ¡ã€‚ BMC æ€»æ˜¯è®© SET è¯·æ±‚é€šè¿‡æ ‡å‡†ç½‘ç»œå †æ ˆï¼ŒåŸå› æœ‰ä¸¤ä¸ªã€‚é¦–å…ˆï¼Œå®ƒå…è®¸é‡ç”¨æ“ä½œç³»ç»Ÿ TCP åè®®å®ç°ï¼ŒåŒ…æ‹¬å‘é€ç¡®è®¤å’Œé‡æ–°ä¼ è¾“æ®µã€‚å…¶æ¬¡ï¼Œå®ƒç¡®ä¿ SET è¯·æ±‚å§‹ç»ˆç”± Memcached åº”ç”¨ç¨‹åºå¤„ç†ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºçš„æ•°æ®ä¿æŒæœ€æ–°ã€‚æˆ‘ä»¬é€‰æ‹©ä¸ä½¿ç”¨ BMC æ‹¦æˆªçš„ SET è¯·æ±‚æ¥æ›´æ–°å†…æ ¸ç¼“å­˜ï¼Œå› ä¸º TCP çš„æ‹¥å¡æ§åˆ¶å¯èƒ½ä¼šåœ¨æ‰§è¡Œåæ‹’ç»æ–°çš„æ®µã€‚è€Œä¸”ï¼Œä½¿ç”¨ SET è¯·æ±‚æ›´æ–°å†…æ ¸ç¼“å­˜éœ€è¦ BMC å’Œ Memcached éƒ½ä»¥ç›¸åŒçš„é¡ºåºå¤„ç† SET è¯·æ±‚ï¼Œä»¥ä¿æŒ BMC ç¼“å­˜çš„ä¸€è‡´æ€§ï¼Œå¦‚æœæ²¡æœ‰è¿‡äºæ˜‚è´µçš„åŒæ­¥æœºåˆ¶ï¼Œè¿™æ˜¯å¾ˆéš¾ä¿è¯çš„ã€‚</p><p>å½“ BMC ç¼“å­˜å‘ç”Ÿæœªå‘½ä¸­æ—¶ï¼ŒGET è¯·æ±‚å°†ä¼ é€’åˆ°ç½‘ç»œå †æ ˆã€‚ç„¶åï¼Œå¦‚æœ Memcached ä¸­å‘ç”Ÿå‘½ä¸­ï¼ŒBMC ä¼šæ‹¦æˆªä¼ å‡ºçš„ GET å›å¤ä»¥æ›´æ–°å…¶ç¼“å­˜ (4c)ã€‚</p><p>BMC å¯ä»¥å—ç›Šäºç°ä»£ NIC åŠŸèƒ½ï¼ˆä¾‹å¦‚å¤šé˜Ÿåˆ—å’Œ RSSï¼‰ï¼Œä»¥ä¾¿åœ¨å¤šä¸ª CPU å†…æ ¸ä¹‹é—´åˆ†é…å¤„ç†ã€‚åŒæ—¶æ”¯æŒå®‰æ’åˆ°ç‰¹å®š CPU æ ¸å¿ƒ</p><h2 id=bmc-ç¼“å­˜è®¾è®¡>BMC ç¼“å­˜è®¾è®¡</h2><p>BMC ç¼“å­˜è¢«è®¾è®¡ä¸ºç”± Memcached é”®ç´¢å¼•çš„å“ˆå¸Œè¡¨ã€‚å®ƒæ˜¯ä¸€ç§ç›´æ¥æ˜ å°„ç¼“å­˜ï¼Œè¿™æ„å‘³ç€å“ˆå¸Œè¡¨ä¸­çš„æ¯ä¸ªæ¡¶ä¸€æ¬¡åªèƒ½å­˜å‚¨ä¸€ä¸ªæ¡ç›®ã€‚ BMC ä½¿ç”¨ 32 ä½ FNV-1a å“ˆå¸Œå‡½æ•°æ¥è®¡ç®—å“ˆå¸Œå€¼ã€‚ç”±äºè¿™æ˜¯ä¸€æ¬¡å¯¹å•ä¸ªå­—èŠ‚è¿›è¡Œæ“ä½œçš„æ»šåŠ¨å“ˆå¸Œå‡½æ•°ï¼Œå› æ­¤å®ƒå…è®¸ BMC åœ¨è§£æ Memcached è¯·æ±‚æ—¶è®¡ç®—å¯†é’¥çš„å“ˆå¸Œå€¼ã€‚ä½¿ç”¨å–æ¨¡è¿ç®—ç¬¦å°†å“ˆå¸Œå€¼ç®€åŒ–ä¸ºç¼“å­˜è¡¨ä¸­çš„ç´¢å¼•ã€‚æ¯ä¸ªç¼“å­˜æ¡ç›®åŒ…å«ä¸€ä¸ªæœ‰æ•ˆä½ã€ä¸€ä¸ªå“ˆå¸Œå€¼ã€ä¸€ä¸ªè‡ªæ—‹é”ã€å®é™…å­˜å‚¨çš„æ•°æ®ä»¥åŠæ•°æ®çš„å¤§å°ã€‚è¿™ç§ç¼“å­˜è®¾è®¡ä¸ºæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œæä¾›äº†æ’å®šçš„æ—¶é—´å¤æ‚åº¦ã€‚ä¸ºäº†éªŒè¯ç¼“å­˜å‘½ä¸­ï¼ŒBMC æ£€æŸ¥ç¼“å­˜æ¡ç›®çš„æœ‰æ•ˆä½æ˜¯å¦å·²è®¾ç½®ä»¥åŠå­˜å‚¨çš„å¯†é’¥æ˜¯ â€‹â€‹ å¦ä¸å¤„ç†çš„è¯·æ±‚çš„å¯†é’¥ç›¸åŒã€‚</p><p>ä¸ºäº†é¿å… eBPF çš„æé™ï¼ŒBMC åŠŸèƒ½é€»è¾‘è¢«åˆ†ä¸ºå¤šä¸ªå°çš„ eBPF ç¨‹åºã€‚åŒæ—¶é™åˆ¶äº†æœ€å¤§çš„é•¿åº¦ 250Bã€‚</p><h2 id=å®ç°æµç¨‹>å®ç°æµç¨‹</h2><p><img src=https://s2.loli.net/2024/04/24/vM1idjZnIeNzSDX.png loading=lazy alt="BMC: Accelerating Memcached using Safe In-kernel Caching and Pre-stack Processing-2024-04-24-20-11-02"></p><p>rx_ï¬lter. ç¬¬ä¸€ä¸ª eBPF ç¨‹åºçš„ç›®æ ‡æ˜¯ä½¿ç”¨ä¸¤æ¡è§„åˆ™è¿‡æ»¤ä¸ Memcached æµé‡ç›¸å¯¹åº”çš„æ•°æ®åŒ…ã€‚ç¬¬ä¸€æ¡è§„åˆ™åŒ¹é… UDP æ•°æ®åŒ…ï¼Œå…¶ç›®æ ‡ç«¯å£å¯¹åº”äº Memcached ä¸”å…¶è´Ÿè½½åŒ…å« GET è¯·æ±‚ã€‚ç¬¬äºŒæ¡è§„åˆ™åŒ¹é…ç›®æ ‡ç«¯å£ä¹Ÿä¸ Memcached å¯¹åº”çš„ TCP æµé‡ã€‚ä¼ å…¥é“¾æ ¹æ®è§„åˆ™åŒ¹é…è¿›è¡Œåˆ†æ”¯ã€‚å¦‚æœä¸¤ä¸ªè§„åˆ™å‡ä¸åŒ¹é…ï¼Œåˆ™ç½‘ç»œå †æ ˆå°†ç…§å¸¸å¤„ç†è¯¥æ•°æ®åŒ…ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nf>SEC</span><span class=p>(</span><span class=s>&#34;bmc_rx_filter&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>bmc_rx_filter_main</span><span class=p>(</span><span class=k>struct</span> <span class=n>xdp_md</span> <span class=o>*</span><span class=n>ctx</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kt>void</span> <span class=o>*</span><span class=n>data_end</span> <span class=o>=</span> <span class=p>(</span><span class=kt>void</span> <span class=o>*</span><span class=p>)(</span><span class=kt>long</span><span class=p>)</span><span class=n>ctx</span><span class=o>-&gt;</span><span class=n>data_end</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>void</span> <span class=o>*</span><span class=n>data</span> <span class=o>=</span> <span class=p>(</span><span class=kt>void</span> <span class=o>*</span><span class=p>)(</span><span class=kt>long</span><span class=p>)</span><span class=n>ctx</span><span class=o>-&gt;</span><span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>ethhdr</span> <span class=o>*</span><span class=n>eth</span> <span class=o>=</span> <span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>iphdr</span> <span class=o>*</span><span class=n>ip</span> <span class=o>=</span> <span class=n>data</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=o>*</span><span class=n>eth</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=kt>void</span> <span class=o>*</span><span class=n>transp</span> <span class=o>=</span> <span class=n>data</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=o>*</span><span class=n>eth</span><span class=p>)</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=o>*</span><span class=n>ip</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>udphdr</span> <span class=o>*</span><span class=n>udp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>struct</span> <span class=n>tcphdr</span> <span class=o>*</span><span class=n>tcp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kt>char</span> <span class=o>*</span><span class=n>payload</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=n>__be16</span> <span class=n>dport</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=n>ip</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&gt;</span> <span class=n>data_end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=n>XDP_PASS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>switch</span> <span class=p>(</span><span class=n>ip</span><span class=o>-&gt;</span><span class=n>protocol</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=nl>IPPROTO_UDP</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=n>udp</span> <span class=o>=</span> <span class=p>(</span><span class=k>struct</span> <span class=n>udphdr</span> <span class=o>*</span><span class=p>)</span> <span class=n>transp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=p>(</span><span class=n>udp</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&gt;</span> <span class=n>data_end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=n>XDP_PASS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=n>dport</span> <span class=o>=</span> <span class=n>udp</span><span class=o>-&gt;</span><span class=n>dest</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=n>payload</span> <span class=o>=</span> <span class=n>transp</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=o>*</span><span class=n>udp</span><span class=p>)</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>memcached_udp_header</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=k>case</span> <span class=nl>IPPROTO_TCP</span><span class=p>:</span>
</span></span><span class=line><span class=cl>			<span class=n>tcp</span> <span class=o>=</span> <span class=p>(</span><span class=k>struct</span> <span class=n>tcphdr</span> <span class=o>*</span><span class=p>)</span> <span class=n>transp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=p>(</span><span class=n>tcp</span> <span class=o>+</span> <span class=mi>1</span> <span class=o>&gt;</span> <span class=n>data_end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=n>XDP_PASS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=n>dport</span> <span class=o>=</span> <span class=n>tcp</span><span class=o>-&gt;</span><span class=n>dest</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=n>payload</span> <span class=o>=</span> <span class=n>transp</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=o>*</span><span class=n>tcp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=k>default</span><span class=o>:</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=n>XDP_PASS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=p>(</span><span class=n>dport</span> <span class=o>==</span> <span class=nf>htons</span><span class=p>(</span><span class=mi>11211</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=n>payload</span><span class=o>+</span><span class=mi>4</span> <span class=o>&lt;=</span> <span class=n>data_end</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=k>if</span> <span class=p>(</span><span class=n>ip</span><span class=o>-&gt;</span><span class=n>protocol</span> <span class=o>==</span> <span class=n>IPPROTO_UDP</span> <span class=o>&amp;&amp;</span> <span class=n>payload</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;g&#39;</span> <span class=o>&amp;&amp;</span> <span class=n>payload</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;e&#39;</span> <span class=o>&amp;&amp;</span> <span class=n>payload</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39;t&#39;</span> <span class=o>&amp;&amp;</span> <span class=n>payload</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39; &#39;</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// is this a GET request
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>zero</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>struct</span> <span class=n>bmc_stats</span> <span class=o>*</span><span class=n>stats</span> <span class=o>=</span> <span class=nf>bpf_map_lookup_elem</span><span class=p>(</span><span class=o>&amp;</span><span class=n>map_stats</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>zero</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>stats</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=n>XDP_PASS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=n>stats</span><span class=o>-&gt;</span><span class=n>get_recv_count</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=k>struct</span> <span class=n>parsing_context</span> <span class=o>*</span><span class=n>pctx</span> <span class=o>=</span> <span class=nf>bpf_map_lookup_elem</span><span class=p>(</span><span class=o>&amp;</span><span class=n>map_parsing_context</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>zero</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>pctx</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=n>XDP_PASS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=n>pctx</span><span class=o>-&gt;</span><span class=n>key_count</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=n>pctx</span><span class=o>-&gt;</span><span class=n>current_key</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=n>pctx</span><span class=o>-&gt;</span><span class=n>write_pkt_offset</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>#pragma clang loop unroll(disable)
</span></span></span><span class=line><span class=cl><span class=cp></span>			<span class=k>for</span> <span class=p>(</span><span class=n>off</span> <span class=o>=</span> <span class=mi>4</span><span class=p>;</span> <span class=n>off</span> <span class=o>&lt;</span> <span class=n>BMC_MAX_PACKET_LENGTH</span> <span class=o>&amp;&amp;</span> <span class=n>payload</span><span class=o>+</span><span class=n>off</span><span class=o>+</span><span class=mi>1</span> <span class=o>&lt;=</span> <span class=n>data_end</span> <span class=o>&amp;&amp;</span> <span class=n>payload</span><span class=p>[</span><span class=n>off</span><span class=p>]</span> <span class=o>==</span> <span class=sc>&#39; &#39;</span><span class=p>;</span> <span class=n>off</span><span class=o>++</span><span class=p>)</span> <span class=p>{}</span> <span class=c1>// move offset to the start of the first key
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>if</span> <span class=p>(</span><span class=n>off</span> <span class=o>&lt;</span> <span class=n>BMC_MAX_PACKET_LENGTH</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=n>pctx</span><span class=o>-&gt;</span><span class=n>read_pkt_offset</span> <span class=o>=</span> <span class=n>off</span><span class=p>;</span> <span class=c1>// save offset
</span></span></span><span class=line><span class=cl><span class=c1></span>				<span class=k>if</span> <span class=p>(</span><span class=nf>bpf_xdp_adjust_head</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=p>(</span><span class=kt>int</span><span class=p>)(</span><span class=k>sizeof</span><span class=p>(</span><span class=o>*</span><span class=n>eth</span><span class=p>)</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=o>*</span><span class=n>ip</span><span class=p>)</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=o>*</span><span class=n>udp</span><span class=p>)</span> <span class=o>+</span> <span class=k>sizeof</span><span class=p>(</span><span class=k>struct</span> <span class=n>memcached_udp_header</span><span class=p>)</span> <span class=o>+</span> <span class=n>off</span><span class=p>)))</span> <span class=p>{</span> <span class=c1>// push headers + &#39;get &#39; keyword
</span></span></span><span class=line><span class=cl><span class=c1></span>					<span class=k>return</span> <span class=n>XDP_PASS</span><span class=p>;</span>
</span></span><span class=line><span class=cl>				<span class=p>}</span>
</span></span><span class=line><span class=cl>				<span class=nf>bpf_tail_call</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>map_progs_xdp</span><span class=p>,</span> <span class=n>BMC_PROG_XDP_HASH_KEYS</span><span class=p>);</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>ip</span><span class=o>-&gt;</span><span class=n>protocol</span> <span class=o>==</span> <span class=n>IPPROTO_TCP</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nf>bpf_tail_call</span><span class=p>(</span><span class=n>ctx</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>map_progs_xdp</span><span class=p>,</span> <span class=n>BMC_PROG_XDP_INVALIDATE_CACHE</span><span class=p>);</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=n>XDP_PASS</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>hash_keys è¯¥ç¨‹åºè®¡ç®—æ•°æ®åŒ…ä¸­åŒ…å«çš„æ¯ä¸ª Memcached GET å¯†é’¥çš„å“ˆå¸Œå€¼ã€‚ç„¶åï¼Œå®ƒæ£€æŸ¥ç›¸åº”çš„ç¼“å­˜æ¡ç›®æ˜¯å¦æœ‰ä»»ä½•ç¼“å­˜å‘½ä¸­æˆ–å“ˆå¸Œå†²çªï¼Œå¹¶å°†å·²å‘½ä¸­çš„å¯†é’¥å“ˆå¸Œä¿å­˜åœ¨æ¯ CPU æ•°ç»„ä¸­ï¼Œè¯¥æ•°ç»„ç”¨äºå­˜å‚¨é“¾æ‰§è¡Œçš„ä¸Šä¸‹æ–‡æ•°æ®ã€‚</p><p>prepare_packet è¯¥ eBPF ç¨‹åºå¢åŠ æ¥æ”¶æ•°æ®åŒ…çš„å¤§å°å¹¶ä¿®æ”¹å…¶åè®®æ ‡å¤´ä»¥å‡†å¤‡å“åº”æ•°æ®åŒ…ï¼Œäº¤æ¢æºå’Œç›®æ ‡ä»¥å¤ªç½‘åœ°å€ã€IP åœ°å€å’Œ UDP ç«¯å£ã€‚ç„¶åå®ƒè°ƒç”¨è¯¥é“¾åˆ†æ”¯çš„æœ€åä¸€ä¸ª eBPF ç¨‹åºã€‚BMC å¯ä»¥æ·»åŠ åˆ°æ•°æ®åŒ…çš„æœ€å¤§å­—èŠ‚æ•°å—åˆ°ç½‘ç»œé©±åŠ¨ç¨‹åºå®ç°çš„é™åˆ¶ã€‚åœ¨æˆ‘ä»¬å½“å‰çš„ BMC å®ç°ä¸­ï¼Œæ ¹æ® BMC é™„åŠ çš„ä¸åŒç½‘ç»œé©±åŠ¨ç¨‹åºï¼Œè¯¥å€¼è®¾ç½®ä¸º 128 å­—èŠ‚ï¼Œå¹¶ä¸”å¯ä»¥å¢åŠ åˆ°æ›´é«˜çš„å€¼ä»¥åŒ¹é…å…¶ä»–ç½‘ç»œé©±åŠ¨ç¨‹åºå®ç°ã€‚</p><p>write_reply è¯¥ eBPF ç¨‹åºæ£€ç´¢ä¿å­˜åœ¨æ¯ä¸ª CPU æ•°ç»„ä¸­çš„å¯†é’¥å“ˆå¸Œï¼Œä»¥å°†ç›¸åº”çš„ç¼“å­˜æ¡ç›®å¤åˆ¶åˆ°æ•°æ®åŒ…çš„æœ‰æ•ˆè´Ÿè½½ä¸­ã€‚å¦‚æœè¡¨åŒ…å«å¤šä¸ªé”®æ•£åˆ—ï¼Œåˆ™æ­¤ eBPF ç¨‹åºå¯ä»¥è°ƒç”¨è‡ªèº«æ¥å¤åˆ¶å“åº”æ•°æ®åŒ…ä¸­å°½å¯èƒ½å¤šçš„é¡¹ç›®ã€‚æœ€åï¼Œä¼ å…¥é“¾çš„è¯¥åˆ†æ”¯é€šè¿‡å°†æ•°æ®åŒ…å‘é€å›ç½‘ç»œè€Œç»“æŸã€‚</p><p>invalidate_cache ä¼ å…¥é“¾çš„ç¬¬äºŒä¸ªåˆ†æ”¯å¤„ç† Memcached TCP æµé‡å¹¶åŒ…å«å•ä¸ª eBPF ç¨‹åºã€‚è¯¥ç¨‹åºåœ¨æ•°æ®åŒ…çš„æœ‰æ•ˆè´Ÿè½½ä¸­æŸ¥æ‰¾ SET è¯·æ±‚ï¼Œå¹¶åœ¨å‘ç°ä½¿ç›¸åº”ç¼“å­˜æ¡ç›®æ— æ•ˆæ—¶è®¡ç®—å¯†é’¥å“ˆå¸Œå€¼ã€‚ä¼ å…¥é“¾çš„è¯¥åˆ†æ”¯å¤„ç†çš„æ•°æ®åŒ…å§‹ç»ˆä¼ è¾“åˆ°ç½‘ç»œå †æ ˆï¼Œä»¥ä¾¿ Memcached å¯ä»¥æ¥æ”¶ SET è¯·æ±‚å¹¶ç›¸åº”åœ°æ›´æ–°è‡ªå·±çš„æ•°æ®ã€‚</p><h1 id=æ€»ç»“>æ€»ç»“</h1><p>æ•´ä¸ªBMCçš„ä»£ç å·¥ä½œé‡ä¸ç®—å¤§ï¼Œçº¦1000LoCçš„Cç¨‹åºï¼Œä¼˜ç‚¹æ˜¯å¯ä»¥ä¸éœ€è¦ä¿®æ”¹æºç¨‹åºï¼Œç›´æ¥é€šè¿‡åˆ°æ¥çš„è¯·æ±‚åˆ¤æ–­memcachedçš„target portå’Œpayloadæ¥è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥ç›´æ¥éƒ¨ç½²åœ¨ç°æœ‰ç³»ç»Ÿä¸Šã€‚</p><p>ç¼ºç‚¹ï¼šæš‚æ—¶åªæ”¯æŒæœ‰é™é•¿åº¦çš„Key/Valueã€‚</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span><a class=link href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.ml target=_blank rel=noopener>Licensed under CC BY-NC-SA 4.0</a></span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script></article><script src=https://giscus.app/client.js data-repo=Chasing1020/Chasing1020.github.io data-repo-id=R_kgDOGR5Ifw data-category=General data-category-id=DIC_kwDOGR5If84CURCm data-mapping=url data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading=lazy crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2019 -
2024 Chasing1020</section><section class=powerby>I just want a peaceful life without troubles<br>Built with <b><a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a></b><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-CDYPFNXQDZ"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CDYPFNXQDZ")</script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css?family=JetBrains+Mono",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>